<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyTSFy - Configs TypeScript Sem Dor</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .code-font { font-family: 'JetBrains Mono', monospace; }
        .json-key { color: #38bdf8; }
        .json-string { color: #a5f3fc; }
        .json-bool { color: #f472b6; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        
        /* Toggle Switch Styles */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #3b82f6;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #3b82f6;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        const IconGlobe = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>;
        const IconCpu = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>;
        const IconLayers = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>;
        const IconInfo = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>;
        const IconCopy = () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>;
        const IconDownload = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;
        const IconClipboard = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>;
        const IconBeaker = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4.5 3h15"></path><path d="M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3"></path><path d="M6 14h12"></path></svg>;

        const initialPresetsData = {
            vite: {
                title: "Vite / Bundlers", icon: <IconGlobe />, desc: "React, Vue, Svelte modernos.",
                config: {
                    target: { val: "ES2020", explain: "Navegadores modernos suportam ES2020." },
                    moduleResolution: { val: "bundler", explain: "O NOVO PADRÃO para bundlers." },
                    isolatedModules: { val: true, explain: "Obrigatório para o Vite." },
                    noEmit: { val: true, explain: "Vite gera o bundle, não o tsc." },
                    lib: { val: ["ES2020", "DOM"], explain: "APIs do navegador + JS moderno." }
                }
            },
            node: {
                title: "Node.js Moderno", icon: <IconCpu />, desc: "Backends e Scripts (Node 18+).",
                config: {
                    module: { val: "NodeNext", explain: "ESM + CommonJS nativo." },
                    outDir: { val: "./dist", explain: "Saída compilada." },
                    strict: { val: true, explain: "Máxima segurança de tipos." },
                    sourceMap: { val: true, explain: "Debug direto no VS Code." }
                }
            },
            next: {
                title: "Next.js", icon: <IconLayers />, desc: "Padrão do framework Next.js.",
                config: {
                    jsx: { val: "preserve", explain: "Next.js compila o JSX." },
                    allowJs: { val: true, explain: "Permite arquivos JS." },
                    incremental: { val: true, explain: "Builds rápidos com cache." },
                    plugins: { val: [{name: "next"}], explain: "Intellisense do Next." }
                }
            }
        };

        const App = () => {
            const [activePreset, setActivePreset] = useState('vite');
            const [hoveredKey, setHoveredKey] = useState(null);
            const [copied, setCopied] = useState(false);
            const [codeCopied, setCodeCopied] = useState(false);
            const [experimental, setExperimental] = useState(false);
            const [displayConfig, setDisplayConfig] = useState(initialPresetsData);

            // Atualiza o JSON exibido quando o switch "experimental" muda
            useEffect(() => {
                // CORREÇÃO: Evitamos usar JSON.stringify em todo o objeto porque ele remove os ícones (elementos React)
                // Fazemos uma cópia rasa do preset e cópia profunda apenas da config
                const newData = {};
                Object.keys(initialPresetsData).forEach(key => {
                    newData[key] = {
                        ...initialPresetsData[key], // Preserva o ícone e título originais
                        config: JSON.parse(JSON.stringify(initialPresetsData[key].config)) // Clona apenas a config
                    };
                });
                
                if (experimental) {
                    Object.keys(newData).forEach(key => {
                        newData[key].config.experimentalDecorators = { 
                            val: true, 
                            explain: "Permite o uso de decorators (@Decorator) usados em NestJS, TypeORM, etc." 
                        };
                        newData[key].config.emitDecoratorMetadata = { 
                            val: true, 
                            explain: "Emite metadados de tipo para decorators. Essencial para injeção de dependência." 
                        };
                    });
                }
                setDisplayConfig(newData);
            }, [experimental]);

            const copyCommand = () => {
                let cmd = "npx mytsfy " + activePreset;
                if (experimental) cmd += " --experimental";
                navigator.clipboard.writeText(cmd);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            const getCleanJSON = () => {
                const configObj = {};
                Object.entries(displayConfig[activePreset].config).forEach(([key, item]) => configObj[key] = item.val);
                return JSON.stringify({ compilerOptions: configObj }, null, 2);
            };

            const downloadConfig = () => {
                const a = document.createElement('a');
                a.href = URL.createObjectURL(new Blob([getCleanJSON()], { type: 'application/json' }));
                a.download = 'tsconfig.json';
                a.click();
            };

            const copyJSON = () => {
                 navigator.clipboard.writeText(getCleanJSON());
                 setCodeCopied(true);
                 setTimeout(() => setCodeCopied(false), 2000);
            }

            return (
                <div className="min-h-screen flex flex-col items-center pb-20">
                    <header className="w-full max-w-5xl mx-auto px-6 py-12 md:py-20 text-center">
                        <div className="inline-flex items-center justify-center p-3 bg-blue-500/10 rounded-full mb-6 border border-blue-500/20">
                            <span className="text-blue-300 font-mono text-sm md:text-base">npm install -g mytsfy</span>
                        </div>
                        <h1 className="text-4xl md:text-7xl font-extrabold tracking-tight mb-6 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">MyTSFy</h1>
                        <p className="text-lg md:text-xl text-slate-400 max-w-2xl mx-auto mb-8 leading-relaxed">Chega de copiar <code>tsconfig.json</code> velho do StackOverflow. Configs modernas em 1 segundo.</p>
                        
                        {/* EXPERIMENTAL TOGGLE */}
                        <div className="flex justify-center mb-10">
                            <div className="flex items-center bg-slate-800 p-3 rounded-lg border border-slate-700 shadow-sm">
                                <div className="mr-3 text-purple-400"><IconBeaker /></div>
                                <div className="mr-4 text-left">
                                    <p className="text-sm font-bold text-slate-200">Experimental Decorators</p>
                                    <p className="text-xs text-slate-500">Útil para NestJS / TypeORM</p>
                                </div>
                                <div className="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" name="toggle" id="toggle" className="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" checked={experimental} onChange={() => setExperimental(!experimental)}/>
                                    <label htmlFor="toggle" className={`toggle-label block overflow-hidden h-6 rounded-full cursor-pointer ${experimental ? 'bg-blue-600' : 'bg-slate-600'}`}></label>
                                </div>
                            </div>
                        </div>

                        <div className="flex flex-col sm:flex-row justify-center gap-4">
                            <button onClick={copyCommand} className="bg-blue-600 hover:bg-blue-500 text-white px-8 py-4 rounded-lg font-bold transition flex items-center justify-center gap-2 text-lg shadow-lg shadow-blue-900/20"><IconCopy /> {copied ? "Copiado!" : `Copiar Comando`}</button>
                            <a href="#explorer" className="bg-slate-800 hover:bg-slate-700 text-white px-8 py-4 rounded-lg font-bold transition border border-slate-700 flex items-center justify-center">Ver Configs</a>
                        </div>
                        {experimental && <p className="mt-4 font-mono text-purple-400 text-sm animate-pulse">Flag --experimental adicionada ao comando!</p>}
                    </header>
                    
                    <section id="explorer" className="w-full max-w-6xl mx-auto px-6 py-16 border-t border-slate-800">
                        <h2 className="text-2xl md:text-3xl font-bold mb-8 text-center">Entenda suas Configs</h2>
                        <div className="grid lg:grid-cols-12 gap-6">
                            <div className="lg:col-span-3 flex flex-row lg:flex-col gap-2 overflow-x-auto lg:overflow-visible pb-4 lg:pb-0">
                                {Object.entries(displayConfig).map(([key, data]) => (
                                    <button key={key} onClick={() => setActivePreset(key)} className={`p-4 rounded-xl text-left transition-all border whitespace-nowrap lg:whitespace-normal flex-1 lg:flex-none ${activePreset === key ? 'bg-blue-600/20 border-blue-500 text-white' : 'bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700'}`}>
                                        <div className="flex items-center gap-3 font-bold mb-1">{data.icon}{data.title}</div>
                                        <p className="text-xs opacity-70 hidden lg:block">{data.desc}</p>
                                    </button>
                                ))}
                            </div>
                            <div className="lg:col-span-5 min-h-[300px]">
                                <div className="bg-slate-900 rounded-xl border border-slate-700 p-6 h-full font-mono text-sm shadow-2xl relative group overflow-hidden">
                                    <div className="flex justify-between items-center mb-4">
                                        <div className="text-slate-500 text-xs select-none">tsconfig.json</div>
                                        <div className="flex gap-2">
                                            <button onClick={copyJSON} className="text-xs flex items-center gap-1 bg-slate-800 hover:bg-slate-700 text-slate-300 px-2 py-1 rounded transition border border-slate-700"><IconClipboard /> {codeCopied ? "Copiado!" : "Copiar JSON"}</button>
                                            <button onClick={downloadConfig} className="text-xs flex items-center gap-1 bg-blue-600/20 hover:bg-blue-600/30 text-blue-400 px-2 py-1 rounded transition border border-blue-500/30"><IconDownload /> Baixar</button>
                                        </div>
                                    </div>
                                    <pre className="overflow-auto h-full code-font custom-scroll pb-10">
                                        <span className="text-slate-500">{'{'}</span><br/><span className="text-slate-500 ml-4">"compilerOptions": {'{'}</span><br/>
                                        {Object.entries(displayConfig[activePreset].config).map(([key, item]) => (
                                            <div key={key} className={`ml-8 cursor-help py-0.5 rounded px-1 transition-colors ${hoveredKey === key ? 'bg-blue-900/50 ring-1 ring-blue-500/50' : 'hover:bg-slate-800'}`} onMouseEnter={() => setHoveredKey(key)} onMouseLeave={() => setHoveredKey(null)} onClick={() => setHoveredKey(key)}>
                                                <span className="json-key">"{key}"</span>: <span className={typeof item.val === 'string' ? 'json-string' : 'json-bool'}>{JSON.stringify(item.val)}</span>,
                                            </div>
                                        ))}<span className="text-slate-500 ml-4">{'}'}</span><br/><span className="text-slate-500">{'}'}</span>
                                    </pre>
                                </div>
                            </div>
                            <div className="lg:col-span-4 min-h-[200px]">
                                <div className="bg-slate-800 border border-slate-700 rounded-xl p-6 h-full flex flex-col justify-center transition-all duration-300">
                                    {hoveredKey ? (
                                        <div>
                                            <div className="text-blue-400 font-mono text-sm mb-2 font-bold bg-blue-900/30 inline-block px-2 py-1 rounded">"{hoveredKey}"</div>
                                            <p className="text-base md:text-lg text-slate-200 leading-relaxed">{displayConfig[activePreset].config[hoveredKey].explain}</p>
                                        </div>
                                    ) : (
                                        <div className="text-center text-slate-500"><p className="text-sm">Toque ou passe o mouse nas propriedades JSON para ver a explicação mágica.</p></div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>